<html>

	<head>
		<meta charset="utf-8">
		<title>Hello MUI</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="css/mui.min.css">
		<style>
			html,
			body {
				background-color: #efeff4;
			}
			
			.imgSize {
				height: 240px !important;
				width: 100% !important;
			}
			
			.title {
				padding: 20px 15px 10px;
				color: #6d6d72;
				font-size: 15px;
				background-color: #fff;
			}
		</style>
		<script type="text/javascript" src="js/jquery-2.1.0.js"></script>

	</head>

	<body>
		<div id="app">
			<div id="pullrefresh" class="mui-content mui-scroll-wrapper">
				<div class="mui-scroll">

					<ul class="mui-table-view mui-table-view-chevron" style="padding: 0px;">
						<li v-for="item in headerData" :id="item[0].id" :data-trapname="item[0].tripAttractionName" :name="item[0].position" class="mui-table-view-cell mui-media" style="padding-left: 0px;padding-right: 0px;padding-top: 0px;padding-bottom: 0px;">
							<div class="mui-card" style="margin: 0px;">
								<!--页眉，放置标题-->

								<!--内容区-->
								<div class="mui-card-content">
									<div class="mui-slider-item">
										<a href="#">
											<a class="mui-slider-title" style="color: #ffffff;">{{item[0].tripAttractionName}}</a>

											<img class="imgSize" :src="item[1]" />
										</a>
									</div>

								</div>

							</div>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<script type="text/javascript" src="js/vue.min.js"></script>
		<script src="js/mui.min.js"></script>
		<script>
			var app = new Vue({
				el: "#app",
				data: {
					message: "nmb",
					headerData: [
						[{
							"tripAttractionName": ""
						}, "", ""]

					],
					cityType: ""

				},
				beforeCreate: function() {

				},
				mounted: function() {

					var that = this
					mui.init({
						swipeBack: false,

						keyEventBind: {
							backbutton: false
						},

						pullRefresh: {
							container: '#pullrefresh',
							down: {
								style: 'circle', //必选，下拉刷新样式，目前支持原生5+ ‘circle’ 样式
								color: '#2BD009', //可选，默认“#2BD009” 下拉刷新控件颜色
								height: '50px', //可选,默认50px.下拉刷新控件的高度,
								range: '100px', //可选 默认100px,控件可下拉拖拽的范围
								offset: '0px', //可选 默认0px,下拉刷新控件的起始位置
								contentrefresh: '正在加载...',
								callback: pulldownRefresh
							},
							up: {
								contentrefresh: '正在加载...',
								callback: pullupRefresh
							}
						}
					});

					var cityType = localStorage.getItem("cityType")
					if(cityType != that.cityType) {
						that.cityType = cityType
						//数据接收
						mui.post('http://47.95.0.73:8080/Uncom/appFront/getTripList.action', {
								type: localStorage.getItem("cityType")
							},
							function(data) {
								var results = JSON.parse(data)
								console.log("data:" + results[0])
								for(var i = 0; i < 4; i++) {
									that.$set(that.headerData, i, results[i]);
								}
								/*	var table = document.body.querySelector('.mui-table-view');
									var viewName = eval(data)
									for(var i = 0; i < 15; i++) {
										var li = document.createElement('li');
										li.className = 'mui-table-view-cell';

										li.innerHTML = '<a class="mui-navigate-right" name="' + viewName[i][0].id + '">' + viewName[i][0].tripAttractionName + '</a>';
										table.insertBefore(li, table.firstChild);
									}
									$('.mui-table-view-cell').on('tap', function(e) {
										var id = $(this).children().attr('name')
										mui.openWindowWithTitle({
											url: 'distination.html',
											id: 'distination',
											extras: {
												dataId: id,
											}
										})
									})*/

							}
						)
					}

					function pulldownRefresh() {
						mui.post('http://47.95.0.73:8080/Uncom/appFront/getTripList.action', {
								type: localStorage.getItem("cityType")
							},
							function(data) {
								var results = JSON.parse(data)
								console.log("data:" + results[0])
								for(var i = 0; i < 4; i++) {
									that.$set(that.headerData, i, results[i]);
								}
								 
							
								
								
								/*	var table = document.body.querySelector('.mui-table-view');
									var viewName = eval(data)
									for(var i = 0; i < 15; i++) {
										var li = document.createElement('li');
										li.className = 'mui-table-view-cell';

										li.innerHTML = '<a class="mui-navigate-right" name="' + viewName[i][0].id + '">' + viewName[i][0].tripAttractionName + '</a>';
										table.insertBefore(li, table.firstChild);
									}
									$('.mui-table-view-cell').on('tap', function(e) {
										var id = $(this).children().attr('name')
										mui.openWindowWithTitle({
											url: 'distination.html',
											id: 'distination',
											extras: {
												dataId: id,
											}
										})
										
									})*/

							}
						)
						 
						 setTimeout("mui('#pullrefresh').pullRefresh().endPulldown();",1000);

					}

					function pullupRefresh() {

						mui.post('http://47.95.0.73:8080/Uncom/appFront/getTripList.action', {
								type: localStorage.getItem("cityType")
							},
							function(data) {
								var results = JSON.parse(data)
								console.log("data:" + results[0])
								for(var i = 0; i < 4; i++) {
									that.$set(that.headerData, i, results[i]);
								}
								/*	var table = document.body.querySelector('.mui-table-view');
									var viewName = eval(data)
									for(var i = 0; i < 15; i++) {
										var li = document.createElement('li');
										li.className = 'mui-table-view-cell';

										li.innerHTML = '<a class="mui-navigate-right" name="' + viewName[i][0].id + '">' + viewName[i][0].tripAttractionName + '</a>';
										table.insertBefore(li, table.firstChild);
									}
									$('.mui-table-view-cell').on('tap', function(e) {
										var id = $(this).children().attr('name')
										mui.openWindowWithTitle({
											url: 'distination.html',
											id: 'distination',
											extras: {
												dataId: id,
											}
										})
									})*/

							}
						)
					}

					$('.mui-table-view-cell').on('tap', function(e) {
						var id = $(this).attr('id')
						var position = $(this).attr("name")
						var trapname = $(this).data("trapname")
						console.log("id:" + id)
						console.log("position:" + position)
						console.log("trapname:" + trapname)
						mui.openWindowWithTitle({
							url: 'distination.html',
							id: 'distination',
							extras: {
								dataId: id,
								position: position,
								trapname: trapname
							}
						})
					})

				}
			})

			/**
			 * 下拉刷新具体业务实现
			 */

			var count = 0;
			/**
			 * 上拉加载具体业务实现
			 */
		</script>
	</body>

</html>